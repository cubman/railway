<rules>
    <rule name="Проверка функционирования стрелки" type="ST" area="SplitPoint.A">
        <group>
            <element code="СТ5"/>
            <element code="СТ9"/>
        </group>
        <preCondition>
            <or>
                <condition>
                    <check state="1"/>
                </condition>
                <condition>
                    <check state="3"/>
                </condition>
            </or>
        </preCondition>
        <postCondition>
            <if>
                <condition>
                    <and>
                        <condition>
                            <check state="1"/>
                        </condition>
                        <condition>
                            <check code="СТ9"/>
                        </condition>
                    </and>
                </condition>
                <then>
                    <and>
                        <condition>
                            <print out="console" level="info"
                                   text="1. Стрелка СТ9 находится в состоянии 1 и выставляем объекту СТ5 состояние."/>
                        </condition>
                        <condition>
                            <setstate area="SplitPoint.A" code="СТ5" state="2"/>
                        </condition>
                    </and>
                </then>
                <else>
                    <if>
                        <condition>
                            <and>
                                <condition>
                                    <check state="3"/>
                                </condition>
                                <condition>
                                    <check code="СТ5"/>
                                </condition>
                            </and>
                        </condition>
                        <then>
                            <and>
                                <condition>
                                    <print out="console" level="info"
                                           text="2. Стрелка СТ5 занята и ожидаем 2 секунды."/>
                                </condition>
                                <condition>
                                    <timer sleep="2"/>
                                </condition>
                                <condition>
                                    <if>
                                        <condition>
                                            <not>
                                                <condition>
                                                    <check state="3"/>
                                                </condition>
                                            </not>
                                        </condition>
                                        <then>
                                            <print out="console" level="info"
                                                   text="3. Стрелка СТ5 занята уже 2 секунды."/>
                                        </then>
                                        <else>
                                            <print out="console" level="info" text="4. Стрелка СТ5 освободилась."/>
                                        </else>
                                    </if>
                                </condition>
                            </and>
                        </then>
                    </if>
                </else>
            </if>
        </postCondition>
    </rule>
</rules>